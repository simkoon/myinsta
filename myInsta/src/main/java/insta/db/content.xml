<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="Content">

  <select id="selectComment" resultType="com.koreait.CommentDTO" parameterType="int">
	SELECT m_userid as coUserid, 
	co_text as coText,
	TIMESTAMPDIFF(MINUTE, NOW(),tb_comment.co_regdate) as coRegdate
	FROM tb_comment JOIN tb_member 
	ON m_idx=co_useridx WHERE co_mcidx=${mcidx};
  </select>
  
  <select id="selectContent" resultType="com.koreait.Content" parameterType="map">
 		SELECT mc_idx, m_userid as mc_useridx, 
  	mc_content,mc_taggedid,mc_taggedname, 
 	mc_regdate, mc_location, mc_imageurl 
 	FROM tb_mycontent JOIN tb_member on mc_useridx=m_idx 
 	JOIN tb_following ON mc_useridx=fi_followingid AND fi_useridx = #{useridx} 
 	ORDER BY tb_mycontent.mc_idx DESC LIMIT #{start}, 5;
  </select>
  
  <insert id="insertComment" useGeneratedKeys="true" keyProperty="id" parameterType="map">
  	INSERT INTO tb_comment(co_useridx, co_mcidx, co_text)
  	VALUES (#{co_useridx}, #{co_mcidx}, #{co_text});
  </insert>
  <select id="selectSearch" resultType="com.koreait.SearchDTO" parameterType="_int">
  SELECT mc_idx,
  mc_imageurl FROM tb_mycontent LIMIT #{start}, 3;
  </select>
</mapper>
