<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>header, footer type</title>
        <link rel="stylesheet" href="./cssforsearch/common.css" type="text/css" />
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
        <script src="./js/main_search_script.js"></script>
        <script>
            $(function () {
                $("#f_btn").on("click", function () {
                    if ($(this).val() == "팔로우") {
                        $(this).css("background-color", "#fff");
                        $(this).val("팔로잉").css("color", "#000").css("border", "1px solid #ccc");
                    } else {
                        $(this).css("background-color", "#0095f6");
                        $(this).val("팔로우").css("color", "#fff");
                    }
                });
            });
        </script>
        <script>
            $(() => {
                let start = 0;
                let pending = false;
                //url에서 get 파라메터 가져오기
                function getParam(name) {
                    if ((name = new RegExp("[?&]" + encodeURIComponent(name) + "=([^&]*)").exec(location.search))) return decodeURIComponent(name[1]);
                }
                console.log(getParam("tag"));
                const getEle = async () => {
                    //    console.log("getele 실행됨");
                    //   console.log(window.scrollY + 1000 > document.querySelector(".images_items").offsetHeight);
                    if (window.scrollY + 1000 > document.querySelector(".images_items").offsetHeight) {
                        // console.log("스타트는 " + start);
                        if (pending) {
                            //  console.log("취소됨");
                            return;
                        }
                        try {
                            //   console.log("여기들어오나");
                            pending = true;
                            const response = await axios.post("./GetSearchServlet", "start=" + start + "&tag=" + getParam("tag"));

                            const newthing = response.data;
                            console.log(newthing.result);
                            let strHtml = /*html*/ ``;

                            for (let i = 0; i < newthing.result.length; i++) {
                                let one_article = newthing.result[i];
                                console.log("길이는 : " + newthing.result.length);
                                if (i % 3 == 0) {
                                    strHtml += /*html*/ `<div class="items_box">`;
                                }
                                strHtml +=
                                    /*html*/
                                    `<div>
                                         <a href="#"><img src="${one_article.img ? one_article.img : "https://www.publicdomainpictures.net/pictures/280000/velka/not-found-image-15383864787lu.jpg"}" alt="#" /></a>
                                    </div>
                                   `;
                                if ((i + 1) % 3 == 0 || i + 1 == newthing.result.length) {
                                    strHtml += /*html*/ `</div>`;
                                }
                            }

                            let doc = document.createElement("div");
                            doc.innerHTML = strHtml;
                            let newArticle = doc.childNodes;
                            console.log(newArticle);
                            $(".images_items").append(newArticle);
                            start += 12;
                        } catch (e) {
                            console.log(e);
                        } finally {
                            pending = false;
                        }
                    }
                };

                // window.addEventListener("scroll", getEle, true);
                $(window).on("scroll", getEle);
                getEle();
            });
        </script>
    </head>
    <body>
        <ul class="skipnavi">
            <li><a href="#container">본문내용</a></li>
        </ul>
        <!-- wrap -->
        <div id="wrap" class="search_wrap">
            <form id="h_reform">
                <!-- 해더부분 -->
                <header id="header">
                    <div class="header_area box_inner clear">
                        <nav>
                            <div class="header_img">
                                <a href="#">
                                    <img class="h_imgsize" src="images/instalogo.png" />
                                </a>
                            </div>
                            <div class="header_search">
                                <input class="h_Search search_re" type="text" placeholder="검색" />
                            </div>
                            <div class="header_meun">
                                <div class="h_meun">
                                    <div class="h_meunlist">
                                        <a href="#">
                                            <svg aria-label="홈" class="ico_btn" fill="#262626" height="22" viewBox="0 0 48 48" width="22">
                                                <path
                                                    d="M45.5 48H30.1c-.8 0-1.5-.7-1.5-1.5V34.2c0-2.6-2.1-4.6-4.6-4.6s-4.6 2.1-4.6 4.6v12.3c0 .8-.7 1.5-1.5 1.5H2.5c-.8 0-1.5-.7-1.5-1.5V23c0-.4.2-.8.4-1.1L22.9.4c.6-.6 1.6-.6 2.1 0l21.5 21.5c.3.3.4.7.4 1.1v23.5c.1.8-.6 1.5-1.4 1.5z"
                                                ></path>
                                            </svg>
                                        </a>
                                    </div>
                                    <div class="h_meunlist">
                                        <a class="m_dm" href="#">
                                            <svg aria-label="메세지보내기" class="ico_btn" fill="#262626" height="22" viewBox="0 0 48 48" width="22">
                                                <path
                                                    d="M47.8 3.8c-.3-.5-.8-.8-1.3-.8h-45C.9 3.1.3 3.5.1 4S0 5.2.4 5.7l15.9 15.6 5.5 22.6c.1.6.6 1 1.2 1.1h.2c.5 0 1-.3 1.3-.7l23.2-39c.4-.4.4-1 .1-1.5zM5.2 6.1h35.5L18 18.7 5.2 6.1zm18.7 33.6l-4.4-18.4L42.4 8.6 23.9 39.7z"
                                                ></path>
                                            </svg>
                                            <div class="m_dmAr">
                                                <div class="dmAr">
                                                    <p class="dmAr_num">1</p>
                                                </div>
                                            </div>
                                        </a>
                                    </div>
                                    <div class="h_meunlist">
                                        <a href="#">
                                            <svg aria-label="타임라인" class="ico_btn" fill="#262626" height="24" viewBox="0 0 48 48" width="24">
                                                <path
                                                    clip-rule="evenodd"
                                                    d="M24 0C10.8 0 0 10.8 0 24s10.8 24 24 24 24-10.8 24-24S37.2 0 24 0zm0 45C12.4 45 3 35.6 3 24S12.4 3 24 3s21 9.4 21 21-9.4 21-21 21zm10.2-33.2l-14.8 7c-.3.1-.6.4-.7.7l-7 14.8c-.3.6-.2 1.3.3 1.7.3.3.7.4 1.1.4.2 0 .4 0 .6-.1l14.8-7c.3-.1.6-.4.7-.7l7-14.8c.3-.6.2-1.3-.3-1.7-.4-.5-1.1-.6-1.7-.3zm-7.4 15l-5.5-5.5 10.5-5-5 10.5z"
                                                    fill-rule="evenodd"
                                                ></path>
                                            </svg>
                                        </a>
                                    </div>
                                    <div class="h_meunlist">
                                        <a class="m_like" href="#">
                                            <svg aria-label="활동피드" class="ico_btn" fill="#262626" height="22" viewBox="0 0 48 48" width="22">
                                                <path
                                                    d="M34.6 6.1c5.7 0 10.4 5.2 10.4 11.5 0 6.8-5.9 11-11.5 16S25 41.3 24 41.9c-1.1-.7-4.7-4-9.5-8.3-5.7-5-11.5-9.2-11.5-16C3 11.3 7.7 6.1 13.4 6.1c4.2 0 6.5 2 8.1 4.3 1.9 2.6 2.2 3.9 2.5 3.9.3 0 .6-1.3 2.5-3.9 1.6-2.3 3.9-4.3 8.1-4.3m0-3c-4.5 0-7.9 1.8-10.6 5.6-2.7-3.7-6.1-5.5-10.6-5.5C6 3.1 0 9.6 0 17.6c0 7.3 5.4 12 10.6 16.5.6.5 1.3 1.1 1.9 1.7l2.3 2c4.4 3.9 6.6 5.9 7.6 6.5.5.3 1.1.5 1.6.5.6 0 1.1-.2 1.6-.5 1-.6 2.8-2.2 7.8-6.8l2-1.8c.7-.6 1.3-1.2 2-1.7C42.7 29.6 48 25 48 17.6c0-8-6-14.5-13.4-14.5z"
                                                ></path>
                                            </svg>
                                        </a>
                                    </div>
                                    <div class="h_meunlist">
                                        <span class="mpage_img mypage" role="link" tabindex="0" style="width: 22px; height: 22px;">
                                            <img
                                                alt="프로필 사진"
                                                class="my_p"
                                                draggable="false"
                                                src="https://scontent-ssn1-1.cdninstagram.com/v/t51.2885-19/s150x150/96290475_946687145757214_8582876264220590080_n.jpg?_nc_ht=scontent-ssn1-1.cdninstagram.com&_nc_ohc=vNhys6d6UJoAX9MgEsY&oh=53216dcb897ac288fca1f87c57c26761&oe=5F0E2E3A"
                                            />
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                </header>
                <!-- 내용부분 -->
                <div id="container" class="search_container">
                    <div class="main_rolling_pc box_inner">
                        <!-- 이 아래부터는 각자알아서 알맞게 -->
                        <div class="search_content">
                            <div class="search_header">
                                <div class="search_img">
                                    <a href="#"><div class="search_img1"></div></a>
                                </div>
                                <div class="search_name">
                                    <h1 class="search_name_h1">#하늘</h1>
                                    <p class="search_name_p1">
                                        게시물
                                        <span>8,702,571</span>
                                    </p>
                                    <p class="search_name_p2"><input type="button" value="팔로우" id="f_btn" /></p>
                                    <p class="search_name_p3">
                                        관련 해시태그
                                        <span><a href="#">#구름</a></span>
                                        <span><a href="#">#노을</a></span>
                                    </p>
                                </div>
                            </div>
                            <div class="search_images">
                                <h2>인기 게시물</h2>
                                <div class="images_items">
                                    <div class="items_box">
                                        <div>
                                            <a href="#"><img src="./images/googleplay.png" alt="#" /></a>
                                        </div>
                                        <div>
                                            <a href="#"><img src="./images/googleplay.png" alt="#" /></a>
                                        </div>
                                        <div>
                                            <a href="#"><img src="./images/googleplay.png" alt="#" /></a>
                                        </div>
                                    </div>
                                    <div class="items_box">
                                        <div>
                                            <a href="#"><img src="./images/googleplay.png" alt="#" /></a>
                                        </div>
                                        <div>
                                            <a href="#"><img src="./images/googleplay.png" alt="#" /></a>
                                        </div>
                                        <div>
                                            <a href="#"><img src="./images/googleplay.png" alt="#" /></a>
                                        </div>
                                    </div>
                                    <div class="items_box">
                                        <div>
                                            <a href="#"><img src="./images/googleplay.png" alt="#" /></a>
                                        </div>
                                        <div>
                                            <a href="#"><img src="./images/googleplay.png" alt="#" /></a>
                                        </div>
                                        <div>
                                            <a href="#"><img src="./images/googleplay.png" alt="#" /></a>
                                        </div>
                                    </div>
                                    <h2 class="box_h2">최근 사진</h2>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <footer id="footer">
                    <div class="footer_area box_inner clear">
                        <div class="f_area1">
                            <ul>
                                <li><a href="https://about.instagram.com/about-us">소개</a></li>
                                <li><a href="https://help.instagram.com/">도움말</a></li>
                                <li><a href="https://about.instagram.com/blog/">홍보 센터</a></li>
                                <li><a href="https://www.instagram.com/developer/">API</a></li>
                                <li><a href="https://www.instagram.com/about/jobs/">채용 정보</a></li>
                                <li><a href="https://help.instagram.com/519522125107875">개인정보처리방법</a></li>
                                <li><a href="https://help.instagram.com/581066165581870">약관</a></li>
                                <li><a href="https://www.instagram.com/explore/locations/">위치</a></li>
                                <li><a href="https://www.instagram.com/directory/profiles/">인기계정</a></li>
                                <li><a href="https://www.instagram.com/directory/hashtags/">해시태그</a></li>
                                <li><a href="">언어</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="f_area2">© 2020 INSTAGRAM FROM 페스타그램</div>
                </footer>
            </form>
        </div>
    </body>
</html>
